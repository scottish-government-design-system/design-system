@use "../../base/helpers/fancy-underscore/fancy-underscore";
@use "../../base/helpers/headings/headings";
@use "../../base/helpers/high-contrast/high-contrast";
@use "../../base/helpers/media-query/media-query";
@use "../../base/settings/colours/colours";

/*
    SITE NAVIGATION
    containing site-navigation and mobile equivalent
*/

// modifiable vars
$site-navigation__mobile-menu-background: colours.$ds_colour__background--primary--dim !default;
$site-navigation__highlight-colour: colours.$ds_colour__border--highlight !default;

// common to both mobile and desktop
$site-navigation__link-padding: 1rem;

.ds_site-navigation {
    @include headings.small-size;

    display: none;

    &__toggle {
        display: none;
    }

    &__list {
        display: block;
        list-style-type: none;
        margin: 0;
    }

    &__item {
        margin-bottom: 0;
    }

    &__link {
        color: currentColor;
        display: block;
        padding: #{$site-navigation__link-padding * 0.5} $site-navigation__link-padding;
        text-decoration: none;
        white-space: nowrap;

        &:focus {
            position: relative;
            z-index: 1;
        }
    }
}

// small screens
@include media-query.media-query(medium-down) {
    .ds_site-navigation {
        background-color: $site-navigation__mobile-menu-background;
        margin: 0 -1rem;

        &--mobile {
            overflow: hidden;
        }

        &__list {
            padding: 1rem;
        }

        &__item:not(:last-child) {
            border-bottom: 0.0625rem solid colours.$ds_colour__border;
        }

        &__link {
            padding-bottom: $site-navigation__link-padding;
            padding-top: $site-navigation__link-padding;

            &:hover:not(:focus),
            &.ds_current {
                $site-navigation__mobile-border-width: 0.25rem;
                border-left: $site-navigation__mobile-border-width solid colours.$ds_colour__brand;
                padding-left: #{$site-navigation__link-padding - $site-navigation__mobile-border-width};
            }
        }
    }

    .ds_site-navigation__toggle:checked ~ .ds_site-navigation,
    .ds_site-navigation--open {
        border-top: 0.0625rem solid colours.$ds_colour__border--faint;
        display: block;
    }
}

@include media-query.media-query(medium) {
    .ds_site-navigation {
        line-height: 2;

        &:not(&--mobile) {
            display: block;
        }

        &__item {
            display: inline-block;
        }

        &__list {
            display: flex;
            flex-wrap: wrap;
            margin: 0 0 0 -1rem;
        }

        .ds_site-navigation__link {
            @include fancy-underscore.fancy-underscore;

            &::after {
                bottom: 0;
                height: 0.1875rems;
            }

            &.ds_current:not(:focus) {
                background-color: colours.$ds_colour__link--current__background;
                color: colours.$ds_colour__text;

                &:after {
                    border-bottom: 0.1875rem solid transparent;
                    left: 0;
                    opacity: 1;
                    right: 0;
                }
            }
        }

        a.ds_site-navigation__link {
            &:focus {
                box-shadow: 0 0.1875rem colours.$ds_colour__link--focus__shadow;
                outline: none;
                padding-bottom: 0.3125rem;

                @include high-contrast.high-contrast-focus;

                &::after {
                    content: none;
                }
            }

            &:hover:not(:focus) {
                background-color: colours.$ds_colour__link--hover__background;
            }
        }
    }
}
